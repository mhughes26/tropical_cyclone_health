---
title: "tropical_cyclone_figures"
author: "Matthew Hughes"
date: "March 9, 2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(sf)
library(tigris)
```
### Point Location Image ###
```{r}
# Creating a map of the Florida panhandle including Tallahassee

florida_zip <- zctas(cb = TRUE, starts_with = "323", 
                    class = "sf")
plot(florida_zip)
```



```{r}
# Creating a small dataframe with latitude and longitude points in Florida panhandle. 

lon <- c(-84.365908,-84.469249,-83.928361,-84.264767)
lat <- c(29.918281,30.281365,30.087633,30.425467)
coordinates <- data.frame(lon, lat)
coordinates
```

```{r}
# Turning the latitude and longitude coordinates into sf objects. 

florida_sf <- coordinates %>% 
  st_as_sf(coords = c("lon", "lat")) %>% 
   st_set_crs(4269)

```

```{r}
# Create map of Florida panhandle with point locations using the latitude and longitude dataframe. 

florida_map <- ggplot() +
  geom_sf(data = florida_zip, fill = "light green", color = "darkcyan") +
  geom_sf(data = florida_sf) +
  ggtitle("Point Locations in Florida Panhandle") +
  labs(x = "Longitude", "Latitude") 

florida_map
```
### Zip Code Shaded Image ###
```{r}
# Creating an image of a zip code in Florida panhandle that is shaded dark blue. 
class(florida_zip)
head(florida_zip)

zipcode <- florida_zip %>%
filter(ZCTA5CE10 == "32340")
zipcode

zipcode_map <- ggplot() + 
  geom_sf(data = florida_zip, fill = "light green", color = "darkcyan") + 
  geom_sf(data = zipcode, fill = "darkcyan") +
  ggtitle("A Zip Code in the Florida Panhandle") +
  labs(x = "Longitude", "Latitude") 

zipcode_map
```
### County Shaded Image ###
```{r}
# Create in image of a county in the Florida panhandle that is shaded in. 

florida_counties <- counties(state = "FL", class = "sf") %>% 
  filter(NAME == "Jefferson")

florida_county_map <- ggplot() + 
  geom_sf(data = florida_zip, fill = "light green", color = "darkcyan") + 
  geom_sf(data = florida_counties, fill = "darkcyan") +
  ggtitle("Jefferson County in the Florida Panhandle") +
  labs(x = "Longitude", "Latitude") 

florida_county_map
```

```{r message = FALSE, warning = FALSE}
library(hurricaneexposuredata)
library(hurricaneexposure)

map_counties(storm = "Michael-2018", metric = "wind")
```

```{r message = FALSE}
library(tidyverse)
data("county_centers")
michael_fl_winds <- county_wind(counties = county_centers %>%
                                  filter(state_name == "Florida") %>% 
                                  pull(fips), 
            start_year = 2018, end_year = 2018, 
            wind_limit = 0) %>% 
  filter(storm_id == "Michael-2018")
head(michael_fl_winds)
```

```{r}
library(viridis)
all_fl_counties <- counties(state = "FL", cb = TRUE, resolution = "20m") %>% 
  mutate(fips = paste0(STATEFP, COUNTYFP)) %>% 
  full_join(michael_fl_winds, by = "fips")
  
florida_county_map2 <- ggplot() + 
  geom_sf(data = all_fl_counties, aes(fill = vmax_sust)) +
  scale_fill_viridis() + 
  theme_void()
florida_county_map2
```

